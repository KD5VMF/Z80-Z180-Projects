10 REM === EULER TOTIENT TABLE (MBASIC-80) ===
20 PRINT "Euler's Totient phi(n) table -> TOTIENT.TXT"
30 INPUT "Upper limit N"; LIM
40 IF LIM<1 THEN PRINT "Nothing to do.": END
50 OPEN "O",1,"TOTIENT.TXT"
60 PRINT #1,"n,phi(n),phi(n)/n"
70 CSUM=0 : PHMAX=0 : ATNMAX=1
80 FOR N=1 TO LIM
90   X=N : GOSUB 500
100  R=PH/N
110  PRINT #1, N;",";INT(PH+0.5);",";R
120  CSUM=CSUM+PH
130  IF PH>PHMAX THEN PHMAX=PH: ATNMAX=N
140  IF N-INT(N/100)*100=0 THEN PRINT "n=";N;"  phi(n) max so far=";PHMAX;" at n=";ATNMAX
150 NEXT N
160 CLOSE 1
170 PRINT "Done. File: TOTIENT.TXT"
180 PRINT "Sum_{n<=N} phi(n) =";CSUM
190 PRINT "Max phi(n) in range =";PHMAX;" at n=";ATNMAX
200 END
500 REM --- TOTIENT: input X, returns PH ---
510 PH=X
520 IF X=1 THEN PH=1 : RETURN
530 M=X : P=2
540 IF P*P>M THEN 580
550 IF M-INT(M/P)*P=0 THEN PH=PH-PH/P
560 IF M-INT(M/P)*P=0 THEN M=M/P : GOTO 560
570 IF P=2 THEN P=3 ELSE P=P+2
575 GOTO 540
580 IF M>1 THEN PH=PH-PH/M
590 RETURN
